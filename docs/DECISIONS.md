# Архитектурные решения (DECISIONS)

> Здесь фиксируем ПОЧЕМУ приняли то или иное решение. Чтобы не возвращаться к обсуждению.

---

## Архитектура

### Почему всё на Raspberry Pi, без Arduino?
- **Дата:** Декабрь 2025
- **Решение:** Один контроллер (RPi) управляет всем — GPIO, сервер, интерфейс
- **Причины:**
  - Меньше точек отказа
  - Проще отладка (один язык, одна система)
  - Не нужен Serial-протокол между устройствами
- **Альтернативы:** Arduino + RPi через Serial — отклонено как избыточное

### Почему Python, а не C#?
- **Дата:** Сентябрь 2025
- **Решение:** Основной язык — Python
- **Причины:**
  - Кроссплатформенность (Windows для разработки, Linux на RPi)
  - Нативная работа с GPIO через RPi.GPIO
  - Готовая библиотека pyirbis для ИРБИС
  - Проще деплой (не нужен Mono/.NET на RPi)
- **Альтернативы:** C# — отклонено из-за сложности деплоя на ARM

---

## Оборудование

### Почему IQRFID-5102, а не RRU9816?
- **Дата:** Январь 2026
- **Решение:** Использовать IQRFID-5102 для UHF меток
- **Причины:**
  - RRU9816 требует Windows DLL — не работает на RPi
  - IQRFID-5102 имеет открытый Serial-протокол (0xA0)
  - Обе читают UHF 860-960 MHz
- **Статус:** Тестирование протокола 0xA0

### Почему один ACR1281U-C для двух типов карт?
- **Дата:** Январь 2026
- **Решение:** Один NFC-ридер читает и библиотечный билет и ЕКП
- **Причины:**
  - Обе карты — NFC 13.56 MHz
  - Различаются по ATR/UID/данным
  - Экономия USB-порта и денег

---

## Бизнес-логика

### Почему возврат только авторизованным?
- **Дата:** 2025
- **Решение:** Книгу может вернуть только тот, кто взял
- **Причины:**
  - Требование библиотеки
  - Защита от подмены книг
  - Корректный учёт в ИРБИС
- **Альтернативы:** Анонимный возврат — отклонено библиотекой

---

## Инфраструктура

### Почему systemctl, а не автозапуск в rc.local?
- **Дата:** Январь 2026
- **Решение:** Использовать systemd сервис
- **Причины:**
  - Автоперезапуск при падении
  - Логирование через journalctl
  - Управление зависимостями
- **TODO:** Создать shelf-server.service

---

*Добавляй новые решения в начало файла*
